daml 1.2 module Test.SellTest where

import Main.YourID
import Main.MyCar



makePartiesFrom names = mapA getParty names

sellTest : Scenario ()
sellTest = 
  scenario do
    [user, evaluator, bank] <- makePartiesFrom ["Bruce", "Wayne_Corp", "Bank_of_Gotham"]
    [company1, company2] <- makePartiesFrom ["Marvel_Car", "DC_Car"]


    creatBruce <- submit user do create UserID with user

    let sell_price = 35800.0
    let agree = MyCar with seller = user; vehicle = "Volvo"; sell_price; evaluator; bank
    agree <- user `submit` do create Pending with agree; sell_price; seller = user; evaluator = user; bank = user

    agree <- evaluator `submit` do exercise agree Eva_Sign

    agree <- bank `submit` do exercise agree Bank_Sign

    let compania = [company1, company2]
    creatBruceCar <- user `submit` do exercise agree Sell_my_Car with dealer_ship = compania

    return ()